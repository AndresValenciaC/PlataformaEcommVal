{"ast":null,"code":"import _classCallCheck from\"/Users/andrescampovalencia/Desktop/S_Proyectos/BackupShop2/13Dic2020 EcommerceAdmin/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/andrescampovalencia/Desktop/S_Proyectos/BackupShop2/13Dic2020 EcommerceAdmin/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/andrescampovalencia/Desktop/S_Proyectos/BackupShop2/13Dic2020 EcommerceAdmin/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/andrescampovalencia/Desktop/S_Proyectos/BackupShop2/13Dic2020 EcommerceAdmin/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{Component}from\"react\";// with es6\nimport{BootstrapTable,TableHeaderColumn}from\"react-bootstrap-table\";import Header from\"../HeaderDash\";import Axios from\"axios\";import Progress from\"../progress\";// Edit cells values and save them\nvar cellEdit={mode:\"dbclick\",blurToSave:true,beforeSaveCell:onBeforeSaveCell,// a hook for before saving cell\nafterSaveCell:onAfterSaveCell};var selectRowProp={mode:\"checkbox\",clickToSelect:true};// Start Crud -- Update Table Producto and table Comercio Producto\nfunction onAfterSaveCell(row,cellName,cellValue){alert(\"Save column \".concat(cellName,\" with value \").concat(cellValue));console.log(cellName);console.log(cellValue);console.log(row.idProducto);var rowStr=\"\";for(var prop in row){rowStr+=prop+\": \"+row[prop]+\"\\n\";}alert(\"The updated row :\\n\"+rowStr);var nombreTienda=row.nombreTienda;var nombreProducto=row.nombreProducto;var descripcionProducto=row.descripcionProducto;var precioUnidadProducto=row.precioUnidadProducto;var cantidadProducto=row.cantidadProducto;var idProducto=row.idProducto;var idCategoriaProducto=row.idCategoriaProducto;var nombreCategoria=row.nombreCategoria;var updateProductA1={nombreTienda:nombreTienda,nombreProducto:nombreProducto,descripcionProducto:descripcionProducto,precioUnidadProducto:precioUnidadProducto,cantidadProducto:cantidadProducto,idProducto:idProducto,idCategoriaProducto:idCategoriaProducto,nombreCategoria:nombreCategoria};var column=cellName;var value=cellValue;var id=row.idProducto;var updateProductA={column:column,value:value,id:id};var urlA=\"/updateProductA\";// table producto\nAxios.post(urlA,updateProductA).then(function(res){//\n}).catch(function(e){//handle your errors\n});var urlB=\"/updateProductB\";// table comecioProducto\nvar updateProductB={column:column,value:value,id:id};Axios.post(urlB,updateProductB).then(function(res){//\n}).catch(function(e){//handle your errors\n});}// End Crud Update Table Producto and table Comercio Producto\nfunction onBeforeSaveCell(row,cellName,cellValue){}/**        VALIDACIONES\n * validator function pass the user input value and row object. In addition, a bool return value is expected\n */function NameValidator(value,row){var response={isValid:true,notification:{type:\"success\",msg:\"\",title:\"\"}};if(!value){response.isValid=false;response.notification.type=\"error\";response.notification.msg=\"Value must be inserted\";response.notification.title=\"Requested Value\";}else if(value.length<8){response.isValid=false;response.notification.type=\"error\";response.notification.msg=\"Value must have 8+ characters\";response.notification.title=\"Invalid Value\";}return response;}function numberValidator(value,row){var nan=isNaN(parseInt(value,10));if(nan){return\" must be a integer!\";}return true;}var tableProd=/*#__PURE__*/function(_Component){_inherits(tableProd,_Component);var _super=_createSuper(tableProd);function tableProd(){var _this;_classCallCheck(this,tableProd);_this=_super.call(this);_this.fileSelectedHandler=function(event){console.log(\"el fileSelectedHandler\"+event.target.files[0]);_this.setState({selectedFile:event.target.files[0]});};_this.fileUploadHandler=function(){var formData=new FormData();var url=\"http://andresteccorp.club/TesisAndres/imagenUploadsProductos.php\";// get the idProducto from state\nvar idProducto=_this.state.clickedRowID;console.log(\"desde fileUploadHandler\"+idProducto);formData.append(\"fileImageProducto\",_this.state.selectedFile);formData.set(\"idProducto\",idProducto);Axios.post(url,formData,{headers:{\"Content-Type\":\"multipart/form-data\"},onUploadProgress:function onUploadProgress(progressEvent){_this.setState({setUploadPorcentage:parseInt(Math.round(progressEvent.loaded*100/progressEvent.total))});}}).then(function(res){var auth=res.data;console.log(\"auth----\"+auth);console.log(\"auth----\"+auth.length);if(auth){alert(\"Imagen subida Satisfactoriamente\");}if(_this.state.setUploadPorcentage==100){_this.componentDidMount();}else{alert(\"Problemas en Subir Imagen\"+\"\\nTratar de Nuevo\");}}).catch(function(e){//handle your errors\n});};_this.state={products:[],lastId:[],selectedFile:null,setUploadPorcentage:0,setUploadFile:\"\",productUpload:\"\",idProducto:\"\",clickedRowID:null};return _this;}_createClass(tableProd,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(\"/productoInfo\").then(function(res){return res.json();}).then(function(products){return _this2.setState({products:products},function(){return console.log(\"products fetched...\",products);});});fetch(\"/maxIdProduct\").then(function(res){return res.json();}).then(function(lastId){return _this2.setState({lastId:lastId},function(){return console.log(\"lastId -- from table product fetched...\",lastId);});});}// ********************* Metodos del CRUD de la tabla *************** \\\\\n},{key:\"handleTableComplete\",value:function handleTableComplete(row){}},{key:\"handleInsertedRow\",value:function handleInsertedRow(row){var newRowStr=\" \";for(var prop in row){newRowStr+=prop+\": \"+row[prop]+\" \\n\";}alert(\"The new row is:\\n \"+newRowStr);var urlA=\"/insertProductA\";var urlB=\"insertProductB\";var idCate=row.nombreCategoria===\"Comida\"?1:6;var productInsertA={namePrIns:row.nombreProducto,idCatePrIns:idCate};var productInsertB={cantProducto:row.cantidadProducto,precioProducto:row.precioUnidadProducto,descrProd:row.descripcionProducto};Axios.post(urlA,productInsertA).then(function(res){//\n}).catch(function(e){//handle your errors\n});Axios.post(urlB,productInsertB).then(function(res){//\n}).catch(function(e){//handle your errors\n});}// cant delete a product that its in pedido process\n},{key:\"handleDeletedRow\",value:function handleDeletedRow(rowKeys){var idRowProd=rowKeys;alert(\"El producto a eliminar es: \"+idRowProd);var deleteP={delProduct:rowKeys};console.log(deleteP);var urlA=\"/deleteProduct\";Axios.post(urlA,deleteP).then(function(res){var auth=res.data;console.log(\"desde tablepro--\"+res.data.err);if(auth.err===true){alert(\"Producto No Se Puede Eliminar \\n\"+\"Producto Se Encuentra En Proceso De Venta\");res.end();}else if(auth.err===false){alert(\"Producto Eliminado\");res.end();}}).catch(function(e){//\n});}},{key:\"priceFormatter\",value:function priceFormatter(cell){return/*#__PURE__*/_jsxs(\"p\",{children:[\"$\",cell]});}// Methods that upload Imagefile and render image from DB\n},{key:\"buttonImageUpload\",value:function buttonImageUpload(cell){var _this3=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{style:{width:80,height:100,marginBottom:20},src:cell}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",onChange:this.fileSelectedHandler}),/*#__PURE__*/_jsx(\"button\",{style:{width:100,height:50},onClick:function onClick(){return _this3.fileUploadHandler();},children:\"UploadFile\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:100,height:20},children:/*#__PURE__*/_jsx(Progress,{percentage:this.state.setUploadPorcentage})})]});}},{key:\"onRowClick\",value:function onRowClick(row){this.setState({clickedRowID:row.idProducto});}},{key:\"render\",value:function render(){this.onRowClick=this.onRowClick.bind(this);console.log(\"clickedRowEstado\"+this.state.clickedRowID);var options={afterTableComplete:this.handleTableComplete,afterDeleteRow:this.handleDeletedRow,afterInsertRow:this.handleInsertedRow,insertBtn:this.createCustomInsertButton,onRowClick:this.onRowClick};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{title1:\"Informacion Productos Comercio\",title2:\"Home\",ruta:\"/homeAdmin\",opcion1:\"Log-Out\",rutaOpcion1:\"\",opcion2:\"CompraProducto\",rutaOpcion2:\"/productShop\",opcion3:\"OfertaProducto\",rutaOpcion3:\"/tableOfert\"}),/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:60,fontFamily:\"fantasy\",marginTop:\"50px\",marginLeft:\"100px\"},children:\"Productos del Comercio\"}),/*#__PURE__*/_jsxs(\"h3\",{style:{fontSize:25,fontFamily:\"fantasy\",marginTop:\"25px\",marginLeft:\"100px\"},children:[\" \",\"No se puede eliminar mas de un producto diferente simult\\xE1neamente\",\" \",/*#__PURE__*/_jsx(\"br\",{}),\" Si el producto se encuentra en proceso de Venta no se puede\",/*#__PURE__*/_jsx(\"br\",{}),\" Si el producto se encuentra en proceso de Pedido no se puede eliminar\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:\"70px\"//     marginLeft: \"150px\",\n//     marginRight: \"150px\"\n},children:/*#__PURE__*/_jsxs(BootstrapTable,{data:this.state.products,striped:true,selectRow:selectRowProp,exportCSV:true,deleteRow:true,cellEdit:cellEdit,options:options,children:[/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",editable:false,dataField:\"idProducto\",isKey:true,children:\"Catalogo ProductoId\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",editable:false,dataField:\"nombreProducto\",filter:{type:\"TextFilter\",delay:1000},children:\"Producto Nombre\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",filter:{type:\"NumberFilter\",delay:1000},dataField:\"idComercioProducto\",editable:false,children:\"Codigo ProductoComercio\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{editable:false,width:\"150\",dataField:\"nombreCategoria\",children:\"Producto Categoria\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",dataField:\"descripcionProducto\",editable:{validator:NameValidator},children:\"Producto Descripci\\xF3n\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",dataField:\"cantidadProducto\",children:\"Producto Stock\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",dataFormat:this.priceFormatter,dataField:\"precioUnidadProducto\",children:\"Producto Precio\"}),/*#__PURE__*/_jsx(TableHeaderColumn,{width:\"150\",dataField:\"imagenProducto\",dataFormat:this.buttonImageUpload.bind(this),editable:false,children:\"Imagen Producto\"})]})})]});}}]);return tableProd;}(Component);export{tableProd as default};","map":{"version":3,"sources":["/Users/andrescampovalencia/Desktop/S_Proyectos/BackupShop2/13Dic2020 EcommerceAdmin/client/src/components/vistas/tableProd.js"],"names":["React","Component","BootstrapTable","TableHeaderColumn","Header","Axios","Progress","cellEdit","mode","blurToSave","beforeSaveCell","onBeforeSaveCell","afterSaveCell","onAfterSaveCell","selectRowProp","clickToSelect","row","cellName","cellValue","alert","console","log","idProducto","rowStr","prop","nombreTienda","nombreProducto","descripcionProducto","precioUnidadProducto","cantidadProducto","idCategoriaProducto","nombreCategoria","updateProductA1","column","value","id","updateProductA","urlA","post","then","res","catch","e","urlB","updateProductB","NameValidator","response","isValid","notification","type","msg","title","length","numberValidator","nan","isNaN","parseInt","tableProd","fileSelectedHandler","event","target","files","setState","selectedFile","fileUploadHandler","formData","FormData","url","state","clickedRowID","append","set","headers","onUploadProgress","progressEvent","setUploadPorcentage","Math","round","loaded","total","auth","data","componentDidMount","products","lastId","setUploadFile","productUpload","fetch","json","newRowStr","idCate","productInsertA","namePrIns","idCatePrIns","productInsertB","cantProducto","precioProducto","descrProd","rowKeys","idRowProd","deleteP","delProduct","err","end","cell","width","height","marginBottom","onRowClick","bind","options","afterTableComplete","handleTableComplete","afterDeleteRow","handleDeletedRow","afterInsertRow","handleInsertedRow","insertBtn","createCustomInsertButton","fontSize","fontFamily","marginTop","marginLeft","delay","validator","priceFormatter","buttonImageUpload"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\n// with es6\nimport { BootstrapTable, TableHeaderColumn } from \"react-bootstrap-table\";\nimport Header from \"../HeaderDash\";\nimport Axios from \"axios\";\nimport Progress from \"../progress\";\n\n// Edit cells values and save them\nconst cellEdit = {\n  mode: \"dbclick\",\n  blurToSave: true,\n  beforeSaveCell: onBeforeSaveCell, // a hook for before saving cell\n  afterSaveCell: onAfterSaveCell,\n};\n\nconst selectRowProp = {\n  mode: \"checkbox\",\n  clickToSelect: true,\n};\n\n// Start Crud -- Update Table Producto and table Comercio Producto\nfunction onAfterSaveCell(row, cellName, cellValue) {\n  alert(`Save column ${cellName} with value ${cellValue}`);\n  console.log(cellName);\n  console.log(cellValue);\n  console.log(row.idProducto);\n  let rowStr = \"\";\n  for (const prop in row) {\n    rowStr += prop + \": \" + row[prop] + \"\\n\";\n  }\n  alert(\"The updated row :\\n\" + rowStr);\n  const nombreTienda = row.nombreTienda;\n  const nombreProducto = row.nombreProducto;\n  const descripcionProducto = row.descripcionProducto;\n  const precioUnidadProducto = row.precioUnidadProducto;\n  const cantidadProducto = row.cantidadProducto;\n  const idProducto = row.idProducto;\n  const idCategoriaProducto = row.idCategoriaProducto;\n  const nombreCategoria = row.nombreCategoria;\n\n  const updateProductA1 = {\n    nombreTienda: nombreTienda,\n    nombreProducto: nombreProducto,\n    descripcionProducto: descripcionProducto,\n    precioUnidadProducto: precioUnidadProducto,\n    cantidadProducto: cantidadProducto,\n    idProducto: idProducto,\n    idCategoriaProducto: idCategoriaProducto,\n    nombreCategoria: nombreCategoria,\n  };\n\n  const column = cellName;\n  const value = cellValue;\n  const id = row.idProducto;\n\n  const updateProductA = {\n    column: column,\n    value: value,\n    id: id,\n  };\n  const urlA = \"/updateProductA\"; // table producto\n  Axios.post(urlA, updateProductA)\n    .then((res) => {\n      //\n    })\n    .catch((e) => {\n      //handle your errors\n    });\n\n  const urlB = \"/updateProductB\"; // table comecioProducto\n  const updateProductB = {\n    column: column,\n    value: value,\n    id: id,\n  };\n\n  Axios.post(urlB, updateProductB)\n    .then((res) => {\n      //\n    })\n    .catch((e) => {\n      //handle your errors\n    });\n}\n// End Crud Update Table Producto and table Comercio Producto\n\nfunction onBeforeSaveCell(row, cellName, cellValue) {}\n\n/**        VALIDACIONES\n * validator function pass the user input value and row object. In addition, a bool return value is expected\n */\nfunction NameValidator(value, row) {\n  const response = {\n    isValid: true,\n    notification: { type: \"success\", msg: \"\", title: \"\" },\n  };\n  if (!value) {\n    response.isValid = false;\n    response.notification.type = \"error\";\n    response.notification.msg = \"Value must be inserted\";\n    response.notification.title = \"Requested Value\";\n  } else if (value.length < 8) {\n    response.isValid = false;\n    response.notification.type = \"error\";\n    response.notification.msg = \"Value must have 8+ characters\";\n    response.notification.title = \"Invalid Value\";\n  }\n  return response;\n}\n\nfunction numberValidator(value, row) {\n  const nan = isNaN(parseInt(value, 10));\n  if (nan) {\n    return \" must be a integer!\";\n  }\n  return true;\n}\n\nexport default class tableProd extends Component {\n  constructor() {\n    super();\n    this.state = {\n      products: [],\n      lastId: [],\n      selectedFile: null,\n      setUploadPorcentage: 0,\n      setUploadFile: \"\",\n      productUpload: \"\",\n      idProducto: \"\",\n      clickedRowID: null,\n    };\n  }\n\n  componentDidMount() {\n    fetch(\"/productoInfo\")\n      .then((res) => res.json())\n      .then((products) =>\n        this.setState({ products }, () =>\n          console.log(\"products fetched...\", products)\n        )\n      );\n\n    fetch(\"/maxIdProduct\")\n      .then((res) => res.json())\n      .then((lastId) =>\n        this.setState({ lastId }, () =>\n          console.log(\"lastId -- from table product fetched...\", lastId)\n        )\n      );\n  }\n\n  // ********************* Metodos del CRUD de la tabla *************** \\\\\n\n  handleTableComplete(row) {}\n\n  handleInsertedRow(row) {\n    let newRowStr = \" \";\n    for (const prop in row) {\n      newRowStr += prop + \": \" + row[prop] + \" \\n\";\n    }\n\n    alert(\"The new row is:\\n \" + newRowStr);\n\n    const urlA = \"/insertProductA\";\n    const urlB = \"insertProductB\";\n    var idCate = row.nombreCategoria === \"Comida\" ? 1 : 6;\n\n    const productInsertA = {\n      namePrIns: row.nombreProducto,\n\n      idCatePrIns: idCate,\n    };\n\n    const productInsertB = {\n      cantProducto: row.cantidadProducto,\n      precioProducto: row.precioUnidadProducto,\n      descrProd: row.descripcionProducto,\n    };\n\n    Axios.post(urlA, productInsertA)\n      .then((res) => {\n        //\n      })\n      .catch((e) => {\n        //handle your errors\n      });\n\n    Axios.post(urlB, productInsertB)\n      .then((res) => {\n        //\n      })\n      .catch((e) => {\n        //handle your errors\n      });\n  }\n\n  // cant delete a product that its in pedido process\n  handleDeletedRow(rowKeys) {\n    const idRowProd = rowKeys;\n    alert(\"El producto a eliminar es: \" + idRowProd);\n\n    const deleteP = {\n      delProduct: rowKeys,\n    };\n    console.log(deleteP);\n\n    const urlA = \"/deleteProduct\";\n    Axios.post(urlA, deleteP)\n      .then((res) => {\n        const auth = res.data;\n\n        console.log(\"desde tablepro--\" + res.data.err);\n        if (auth.err === true) {\n          alert(\n            \"Producto No Se Puede Eliminar \\n\" +\n              \"Producto Se Encuentra En Proceso De Venta\"\n          );\n          res.end();\n        } else if (auth.err === false) {\n          alert(\"Producto Eliminado\");\n\n          res.end();\n        }\n      })\n      .catch((e) => {\n        //\n      });\n  }\n\n  priceFormatter(cell) {\n    return <p>${cell}</p>;\n  }\n\n  // Methods that upload Imagefile and render image from DB\n\n  fileSelectedHandler = (event) => {\n    console.log(\"el fileSelectedHandler\" + event.target.files[0]);\n\n    this.setState({\n      selectedFile: event.target.files[0],\n    });\n  };\n\n  fileUploadHandler = () => {\n    const formData = new FormData();\n\n    let url =\n      \"http://andresteccorp.club/TesisAndres/imagenUploadsProductos.php\";\n\n    // get the idProducto from state\n\n    var idProducto = this.state.clickedRowID;\n\n    console.log(\"desde fileUploadHandler\" + idProducto);\n    formData.append(\"fileImageProducto\", this.state.selectedFile);\n\n    formData.set(\"idProducto\", idProducto);\n\n    Axios.post(url, formData, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n      },\n\n      onUploadProgress: (progressEvent) => {\n        this.setState({\n          setUploadPorcentage: parseInt(\n            Math.round((progressEvent.loaded * 100) / progressEvent.total)\n          ),\n        });\n      },\n    })\n\n      .then((res) => {\n        const auth = res.data;\n\n        console.log(\"auth----\" + auth);\n\n        console.log(\"auth----\" + auth.length);\n        if (auth) {\n          alert(\"Imagen subida Satisfactoriamente\");\n        }\n        if (this.state.setUploadPorcentage == 100) {\n          this.componentDidMount();\n        } else {\n          alert(\"Problemas en Subir Imagen\" + \"\\nTratar de Nuevo\");\n        }\n      })\n      .catch((e) => {\n        //handle your errors\n      });\n  };\n\n  buttonImageUpload(cell) {\n    return (\n      <div>\n        <img style={{ width: 80, height: 100, marginBottom: 20 }} src={cell} />\n        <input type=\"file\" name=\"file\" onChange={this.fileSelectedHandler} />\n        <button\n          style={{\n            width: 100,\n            height: 50,\n          }}\n          onClick={() => this.fileUploadHandler()}\n        >\n          UploadFile\n        </button>\n        <div\n          style={{\n            width: 100,\n            height: 20,\n          }}\n        >\n          <Progress percentage={this.state.setUploadPorcentage} />\n        </div>\n      </div>\n    );\n  }\n\n  onRowClick(row) {\n    this.setState({ clickedRowID: row.idProducto });\n  }\n  render() {\n    this.onRowClick = this.onRowClick.bind(this);\n    console.log(\"clickedRowEstado\" + this.state.clickedRowID);\n    const options = {\n      afterTableComplete: this.handleTableComplete,\n      afterDeleteRow: this.handleDeletedRow,\n      afterInsertRow: this.handleInsertedRow,\n      insertBtn: this.createCustomInsertButton,\n      onRowClick: this.onRowClick,\n    };\n\n    return (\n      <div>\n        <Header\n          title1=\"Informacion Productos Comercio\"\n          title2=\"Home\"\n          ruta=\"/homeAdmin\"\n          opcion1=\"Log-Out\"\n          rutaOpcion1=\"\"\n          opcion2=\"CompraProducto\"\n          rutaOpcion2=\"/productShop\"\n          opcion3=\"OfertaProducto\"\n          rutaOpcion3=\"/tableOfert\"\n        />\n\n        <h1\n          style={{\n            fontSize: 60,\n            fontFamily: \"fantasy\",\n            marginTop: \"50px\",\n            marginLeft: \"100px\",\n          }}\n        >\n          Productos del Comercio\n        </h1>\n        <h3\n          style={{\n            fontSize: 25,\n            fontFamily: \"fantasy\",\n            marginTop: \"25px\",\n            marginLeft: \"100px\",\n          }}\n        >\n          {\" \"}\n          No se puede eliminar mas de un producto diferente simultáneamente{\" \"}\n          <br /> Si el producto se encuentra en proceso de Venta no se puede\n          <br /> Si el producto se encuentra en proceso de Pedido no se puede\n          eliminar\n        </h3>\n\n        <div\n          style={{\n            marginTop: \"70px\",\n            //     marginLeft: \"150px\",\n            //     marginRight: \"150px\"\n          }}\n        >\n          <BootstrapTable\n            data={this.state.products}\n            striped\n            selectRow={selectRowProp}\n            exportCSV\n            deleteRow={true}\n            cellEdit={cellEdit}\n            options={options}\n          >\n            <TableHeaderColumn\n              width=\"150\"\n              editable={false}\n              dataField=\"idProducto\"\n              isKey={true}\n            >\n              Catalogo ProductoId\n            </TableHeaderColumn>\n            <TableHeaderColumn\n              width=\"150\"\n              editable={false}\n              dataField=\"nombreProducto\"\n              filter={{ type: \"TextFilter\", delay: 1000 }}\n            >\n              Producto Nombre\n            </TableHeaderColumn>\n            <TableHeaderColumn\n              width=\"150\"\n              filter={{ type: \"NumberFilter\", delay: 1000 }}\n              dataField=\"idComercioProducto\"\n              editable={false}\n            >\n              Codigo ProductoComercio\n            </TableHeaderColumn>\n\n            <TableHeaderColumn\n              editable={false}\n              width=\"150\"\n              dataField=\"nombreCategoria\"\n            >\n              Producto Categoria\n            </TableHeaderColumn>\n            <TableHeaderColumn\n              width=\"150\"\n              dataField=\"descripcionProducto\"\n              editable={{ validator: NameValidator }}\n            >\n              Producto Descripción\n            </TableHeaderColumn>\n\n            <TableHeaderColumn width=\"150\" dataField=\"cantidadProducto\">\n              Producto Stock\n            </TableHeaderColumn>\n            <TableHeaderColumn\n              width=\"150\"\n              dataFormat={this.priceFormatter}\n              dataField=\"precioUnidadProducto\"\n            >\n              Producto Precio\n            </TableHeaderColumn>\n            <TableHeaderColumn\n              width=\"150\"\n              dataField=\"imagenProducto\"\n              dataFormat={this.buttonImageUpload.bind(this)}\n              editable={false}\n            >\n              Imagen Producto\n            </TableHeaderColumn>\n          </BootstrapTable>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}